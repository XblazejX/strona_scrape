<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Social Tabs</title>
  <link rel="stylesheet" href="static/style.css" />
</head>
<body>

  <!-- Formularz wprowadzania danych -->
  <div id="form-section">
    <h1>Podaj nazwy użytkowników</h1>
    <input id="input-instagram" placeholder="Instagram Username" />
    <input id="input-youtube" placeholder="YouTube Username" />
    <input id="input-tiktok" placeholder="TikTok Username" />
    <input id="input-twitch" placeholder="Twitch Username" />
    <button onclick="sendData()">Dalej</button>
  </div>

  <!-- Zakładki po zakończeniu procesu -->
  <div id="tabs-section" style="display: none;">
    <div class="tabs">
      <button class="tab" id="instagram-tab" style="display: none;" onclick="openTab('instagram')">
        <div class="tab-content-wrapper">
          <img src="static/icons/logo_instagram.png" alt="Instagram" class="tab-icon" />
          <span class="tab-text">Instagram</span>
        </div>
      </button>
      <button class="tab" id="youtube-tab" style="display: none;" onclick="openTab('youtube')">
        <div class="tab-content-wrapper">
          <img src="static/icons/logo_youtube.png" alt="YouTube" class="tab-icon" />
          <span class="tab-text">YouTube</span>
        </div>
      </button>
      <button class="tab" id="tiktok-tab" style="display: none;" onclick="openTab('tiktok')">
        <div class="tab-content-wrapper">
          <img src="static/icons/logo_tiktok.png" alt="TikTok" class="tab-icon" />
          <span class="tab-text">TikTok</span>
        </div>
      </button>
      <button class="tab" id="twitch-tab" style="display: none;" onclick="openTab('twitch')">
        <div class="tab-content-wrapper">
          <img src="static/icons/logo_twitch.png" alt="Twitch" class="tab-icon" />
          <span class="tab-text">Twitch</span>
        </div>
      </button>
    </div>

    <!-- Zakładki zawierające dane -->
    <div class="tab-content" id="instagram-content" style="display: none;">
      <img src="static/zdjecia/instagram.jpg" alt="Instagram profile" class="profile-img" />
      <a id="instagram-link" class="profile-link" target="_blank">
        <img src="static/icons/logo_instagram.png" class="link-icon" alt="Instagram" />
        <span id="instagram-name"></span>
      </a>
    </div>

    <div class="tab-content" id="youtube-content" style="display: none;">
      <img src="static/zdjecia/youtube.jpg" alt="YouTube profile" class="profile-img" />
      <a id="youtube-link" class="profile-link" target="_blank">
        <img src="static/icons/logo_youtube.png" class="link-icon" alt="YouTube" />
        <span id="youtube-name"></span>
      </a>
    </div>

    <div class="tab-content" id="tiktok-content" style="display: none;">
      <img src="static/zdjecia/tiktok.jpg" alt="TikTok profile" class="profile-img" />
      <a id="tiktok-link" class="profile-link" target="_blank">
        <img src="static/icons/logo_tiktok.png" class="link-icon" alt="TikTok" />
        <span id="tiktok-name"></span>
      </a>
    </div>

    <div class="tab-content" id="twitch-content" style="display: none;">
      <img src="static/zdjecia/twitch.jpg" alt="Twitch profile" class="profile-img" />
      <a id="twitch-link" class="profile-link" target="_blank">
        <img src="static/icons/logo_twitch.png" class="link-icon" alt="Twitch" />
        <span id="twitch-name"></span>
      </a>
    </div>
  </div>

  <!-- Loader (będzie widoczny po kliknięciu przycisku "Dalej") -->
  <div id="loader" class="loader" style="display: none;">
    <div class="spinner"></div>
    <p>Trwa przetwarzanie... Proszę czekać.</p>
  </div>

  <script src="static/main.js"></script>
  <script src="static/zdjecia/dane.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const formSection = document.getElementById("form-section");
      const tabsSection = document.getElementById("tabs-section");
      const loader = document.getElementById("loader");

      // Przyciski zakładek
      const instagramTab = document.getElementById("instagram-tab");
      const youtubeTab = document.getElementById("youtube-tab");
      const tiktokTab = document.getElementById("tiktok-tab");
      const twitchTab = document.getElementById("twitch-tab");

      // Zakładki zawierające dane
      const instagramContent = document.getElementById("instagram-content");
      const youtubeContent = document.getElementById("youtube-content");
      const tiktokContent = document.getElementById("tiktok-content");
      const twitchContent = document.getElementById("twitch-content");

      // Funkcja wysyłająca dane z formularza do backendu
      function sendData() {
        const instagramUsername = document.getElementById("input-instagram").value;
        const youtubeUsername = document.getElementById("input-youtube").value;
        const tiktokUsername = document.getElementById("input-tiktok").value;
        const twitchUsername = document.getElementById("input-twitch").value;

        // Pokaż loader
        loader.style.display = "block";
        formSection.style.display = "none";  // Ukryj formularz

        const data = {
          instagram: instagramUsername,
          youtube: youtubeUsername,
          tiktok: tiktokUsername,
          twitch: twitchUsername
        };

        // Wyślij dane do backendu
        fetch("/run-scraper", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(responseData => {
          // Ukryj loader
          loader.style.display = "none";
          tabsSection.style.display = "block";  // Pokaż zakładki

          // Zaktualizuj zakładki i dane w tabach
          if (responseData.instagram) {
            instagramTab.style.display = "inline-block";
            instagramContent.style.display = "block";
            document.getElementById("instagram-name").textContent = responseData.instagram.name;
            document.getElementById("instagram-link").href = responseData.instagram.url;
          }
          if (responseData.youtube) {
            youtubeTab.style.display = "inline-block";
            youtubeContent.style.display = "block";
            document.getElementById("youtube-name").textContent = responseData.youtube.name;
            document.getElementById("youtube-link").href = responseData.youtube.url;
          }
          if (responseData.tiktok) {
            tiktokTab.style.display = "inline-block";
            tiktokContent.style.display = "block";
            document.getElementById("tiktok-name").textContent = responseData.tiktok.name;
            document.getElementById("tiktok-link").href = responseData.tiktok.url;
          }
          if (responseData.twitch) {
            twitchTab.style.display = "inline-block";
            twitchContent.style.display = "block";
            document.getElementById("twitch-name").textContent = responseData.twitch.name;
            document.getElementById("twitch-link").href = responseData.twitch.url;
          }

          // Domyślnie otwieramy pierwszą zakładkę (np. Instagram)
          openTab("instagram");
        })
        .catch(error => {
          console.error("Error:", error);
          loader.style.display = "none";
          formSection.style.display = "block";  // Pokaż formularz, jeśli wystąpił błąd
        });
      }

      // Obsługuje kliknięcie przycisku
      document.querySelector("button").addEventListener("click", function () {
        sendData();
      });

      // Funkcja otwierająca odpowiednią zakładkę
      function openTab(platform) {
        // Lista platform
        const platforms = ['instagram', 'youtube', 'tiktok', 'twitch'];
        
        // Ukrywamy wszystkie zawartości
        platforms.forEach(function (platformName) {
          document.getElementById(platformName + '-content').style.display = 'none';
          document.getElementById(platformName + '-tab').classList.remove("active");
        });

        // Pokazujemy odpowiednią zakładkę i jej treść
        document.getElementById(platform + '-content').style.display = 'block';
        document.getElementById(platform + '-tab').classList.add("active");
      }

      // Nasłuchujemy na kliknięcia poszczególnych zakładek
      instagramTab.addEventListener("click", function () {
        openTab("instagram");
      });
      youtubeTab.addEventListener("click", function () {
        openTab("youtube");
      });
      tiktokTab.addEventListener("click", function () {
        openTab("tiktok");
      });
      twitchTab.addEventListener("click", function () {
        openTab("twitch");
      });

      // Exportowanie funkcji do globalnego zakresu
      window.openTab = openTab;
    });
  </script>

</body>
</html>
