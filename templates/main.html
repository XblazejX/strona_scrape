<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Social Tabs</title>
  <link rel="stylesheet" href="static/style.css" />
</head>
<body>

  <!-- Ekran początkowy -->
  <div id="start-section">
    <h1>Witaj! Podaj swoją nazwę</h1>
    <input id="initial-name" placeholder="Twoja nazwa" />
    <button onclick="showForm()">Dalej</button>
  </div>

  <!-- Formularz wprowadzania danych -->
  <div id="form-section" style="display: none;">
    <h1>Podaj nazwy użytkowników</h1>
    <input id="input-instagram" placeholder="Instagram Username" />
    <input id="input-youtube" placeholder="YouTube Username" />
    <input id="input-tiktok" placeholder="TikTok Username" />
    <input id="input-twitch" placeholder="Twitch Username" />
    <button onclick="sendData()">Dalej</button>
  </div>

  <!-- Zakładki po zakończeniu procesu -->
  <div id="tabs-section" style="display: none;">
    <div class="tabs">
      <button class="tab" id="instagram-tab" style="display: none;" onclick="openTab('instagram')">
        <div class="tab-content-wrapper">
          <img src="static/icons/logo_instagram.png" alt="Instagram" class="tab-icon" />
          <span class="tab-text">Instagram</span>
        </div>
      </button>
      <button class="tab" id="youtube-tab" style="display: none;" onclick="openTab('youtube')">
        <div class="tab-content-wrapper">
          <img src="static/icons/logo_youtube.png" alt="YouTube" class="tab-icon" />
          <span class="tab-text">YouTube</span>
        </div>
      </button>
      <button class="tab" id="tiktok-tab" style="display: none;" onclick="openTab('tiktok')">
        <div class="tab-content-wrapper">
          <img src="static/icons/logo_tiktok.png" alt="TikTok" class="tab-icon" />
          <span class="tab-text">TikTok</span>
        </div>
      </button>
      <button class="tab" id="twitch-tab" style="display: none;" onclick="openTab('twitch')">
        <div class="tab-content-wrapper">
          <img src="static/icons/logo_twitch.png" alt="Twitch" class="tab-icon" />
          <span class="tab-text">Twitch</span>
        </div>
      </button>
    </div>

    <!-- Zawartość zakładek -->
    <div class="tab-content" id="instagram-content">
      <img src="static/zdjecia/instagram.jpg" alt="Instagram profile" class="profile-img" />
      <a id="instagram-link" class="profile-link" target="_blank">
        <img src="static/icons/logo_instagram.png" class="link-icon" alt="Instagram" />
        <span id="instagram-name"></span>
      </a>
    </div>

    <div class="tab-content" id="youtube-content">
      <img src="static/zdjecia/youtube.jpg" alt="YouTube profile" class="profile-img" />
      <a id="youtube-link" class="profile-link" target="_blank">
        <img src="static/icons/logo_youtube.png" class="link-icon" alt="YouTube" />
        <span id="youtube-name"></span>
      </a>
    </div>

    <div class="tab-content" id="tiktok-content">
      <img src="static/zdjecia/tiktok.jpg" alt="TikTok profile" class="profile-img" />
      <a id="tiktok-link" class="profile-link" target="_blank">
        <img src="static/icons/logo_tiktok.png" class="link-icon" alt="TikTok" />
        <span id="tiktok-name"></span>
      </a>
    </div>

    <div class="tab-content" id="twitch-content">
      <img src="static/zdjecia/twitch.jpg" alt="Twitch profile" class="profile-img" />
      <a id="twitch-link" class="profile-link" target="_blank">
        <img src="static/icons/logo_twitch.png" class="link-icon" alt="Twitch" />
        <span id="twitch-name"></span>
      </a>
    </div>
  </div>

  <!-- Loader -->
  <div id="loader" class="loader" style="display: none;">
    <div class="spinner"></div>
    <p>Trwa przetwarzanie... Proszę czekać.</p>
  </div>

  <script src="static/main.js"></script>
  <script src="static/zdjecia/dane.js"></script>

  <script>
    const formSection = document.getElementById("form-section");
    const tabsSection = document.getElementById("tabs-section");
    const loader = document.getElementById("loader");
    const startSection = document.getElementById("start-section");

    // Przycisk "Dalej" z ekranu startowego
    function showForm() {
      const name = document.getElementById("initial-name").value.trim();
      if (name === "") {
        alert("Proszę podać nazwę.");
        return;
      }
      startSection.style.display = "none";
      formSection.style.display = "flex";
    }

    function sendData() {
      const instagramUsername = document.getElementById("input-instagram").value;
      const youtubeUsername = document.getElementById("input-youtube").value;
      const tiktokUsername = document.getElementById("input-tiktok").value;
      const twitchUsername = document.getElementById("input-twitch").value;

      loader.style.display = "block";
      formSection.style.display = "none";

      const data = {
        instagram: instagramUsername,
        youtube: youtubeUsername,
        tiktok: tiktokUsername,
        twitch: twitchUsername
      };

      fetch("/run-scraper", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      })
      .then(response => response.json())
      .then(responseData => {
        loader.style.display = "none";
        tabsSection.style.display = "block";

        if (responseData.instagram) {
          document.getElementById("instagram-tab").style.display = "inline-block";
          document.getElementById("instagram-content").style.display = "block";
          document.getElementById("instagram-name").textContent = responseData.instagram.name;
          document.getElementById("instagram-link").href = responseData.instagram.url;
        }
        if (responseData.youtube) {
          document.getElementById("youtube-tab").style.display = "inline-block";
          document.getElementById("youtube-content").style.display = "block";
          document.getElementById("youtube-name").textContent = responseData.youtube.name;
          document.getElementById("youtube-link").href = responseData.youtube.url;
        }
        if (responseData.tiktok) {
          document.getElementById("tiktok-tab").style.display = "inline-block";
          document.getElementById("tiktok-content").style.display = "block";
          document.getElementById("tiktok-name").textContent = responseData.tiktok.name;
          document.getElementById("tiktok-link").href = responseData.tiktok.url;
        }
        if (responseData.twitch) {
          document.getElementById("twitch-tab").style.display = "inline-block";
          document.getElementById("twitch-content").style.display = "block";
          document.getElementById("twitch-name").textContent = responseData.twitch.name;
          document.getElementById("twitch-link").href = responseData.twitch.url;
        }

        openTab("instagram"); // domyślnie otwieramy pierwszą
      })
      .catch(error => {
        console.error("Błąd:", error);
        loader.style.display = "none";
        formSection.style.display = "flex";
      });
    }

    function openTab(platform) {
      const platforms = ["instagram", "youtube", "tiktok", "twitch"];
      platforms.forEach(p => {
        document.getElementById(`${p}-content`).style.display = "none";
        document.getElementById(`${p}-tab`).classList.remove("active");
      });

      document.getElementById(`${platform}-content`).style.display = "block";
      document.getElementById(`${platform}-tab`).classList.add("active");
    }

    window.showForm = showForm;
    window.sendData = sendData;
    window.openTab = openTab;
  </script>
</body>
</html>
